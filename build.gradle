group 'org.comroid'

tasks.findByName('wrapper').configure {
    gradleVersion = '5.6'
    distributionUrl = "https://services.gradle.org/distributions/gradle-$gradleVersion-all.zip"
}

configurations {
    compileClasspath {
        resolutionStrategy.activateDependencyLocking()
    }
}

subprojects {
    apply plugin: 'java-library'

    group rootProject.group

    apply from: "$rootDir/gradle/vars.gradle"
    apply from: "$rootDir/gradle/global.gradle"

    afterEvaluate {
        apply from: "$rootDir/gradle/publishing.gradle"
    }

    task allJavadoc(type: Javadoc) {
        source = files(exportedProjects
                .each { rootProject.project(it.toString()) }
                .every { project.hasProperty("sourceSet") }
                .each { project.sourceSets.main.allJava }
                .collect())
        classpath = files(exportedProjects
                .each { rootProject.project(it.toString()) }
                .every { project.hasProperty("sourceSet") }
                .each { project.sourceSets.main.compileClasspath }
                .collect())
        options {
            destinationDirectory(file("$rootDir/docs/"))
            encoding = 'UTF-8'
        }
    }
}

allprojects {
    task generateGithubPom(type: GenerateMavenPom) {
        destination = file("$projectDir/pom.xml")
        pom = publishing.publications.mavenJava.pom
    }
}
